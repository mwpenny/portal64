cutscenes:
  INTRO:
    - q_sound AMBIENCE_BASE CH_AMBIENT SubtitleKeyNone 0.55
  SIGNAGE:
    - activate_signage 15
    - q_sound 10_PART1_ENTRY_1 CH_GLADOS PORTAL_10_PART1_ENTRY_1
    - q_sound 10_PART1_ENTRY_2 CH_GLADOS PORTAL_10_PART1_ENTRY_2
    - q_sound 10_PART1_ENTRY_3 CH_GLADOS PORTAL_10_PART1_ENTRY_3
  ROOM2:
    - set_signal room2_launch_ball
    - wait_for_signal room2_solved
    - label room2_piston_loop
    - play_animation room2_piston piston_move_down
    - wait_for_signal room2_on_piston
    - play_animation room2_piston piston_move_down -1
    - wait_for_signal room2_piston_needed
    - goto room2_piston_loop

  # ENTERED_FINAL_ROOM:
  #   - set_signal final_room_ball_launcher
  #   - start_cutscene SWITCH_ROOM_1_PISTON
  #   - start_cutscene SWITCH_ROOM_2_PISTON
  #   - start_cutscene CHECK_TRAPPED
  #   # TODO: disable spawning (looping) of hazard hallway platforms
  #   - save_checkpoint

  #   - wait_for_signal exit_activate
  #   - save_checkpoint
  #   - q_sound 10_PART1_SUCCESS_1 CH_GLADOS PORTAL_10_PART1_SUCCESS_1

  #   - label exit_piston_loop
  #   - play_animation exit_piston exit_down
  #   - wait_for_signal on_exit_piston
  #   - play_animation exit_piston exit_down -1
  #   - wait_for_signal not_on_exit_piston
  #   - goto exit_piston_loop

  # SWITCH_ROOM_1_PISTON:
  #   - label piston_loop
  #   - play_animation switch_room_1 switch_room_1_down
  #   - wait_for_signal on_switch_room_1_piston
  #   - play_animation switch_room_1 switch_room_1_down -1
  #   - wait_for_signal not_on_switch_room_1_piston
  #   - goto piston_loop

  # SWITCH_ROOM_2_PISTON:
  #   - label piston_loop
  #   - play_animation switch_room_2 switch_room_2_down
  #   - wait_for_signal on_switch_room_2_piston
  #   - play_animation switch_room_2 switch_room_2_down -1
  #   - wait_for_signal not_on_switch_room_2_piston
  #   - goto piston_loop

  # CHECK_TRAPPED:
  #   - label trapped_loop
  #   - wait_for_signal trapped 30
  #   - q_sound 07_PART1_TRAPPED_1 CH_GLADOS PORTAL_07_PART1_TRAPPED_1
  #   - q_sound 07_PART1_TRAPPED_2 CH_GLADOS PORTAL_07_PART1_TRAPPED_2
  #   - wait_for_channel CH_GLADOS
  #   - play_animation escape_hatch escape_hatch_open
  #   - wait_for_signal not_in_ball_trap 30
  #   - play_animation escape_hatch escape_hatch_open -1
  #   - goto trapped_loop

operators:
  - room2_not_on_piston = not room2_on_piston
  # - not_on_exit_piston = not on_exit_piston
  # - not_on_switch_room_1_piston = not on_switch_room_1_piston
  # - not_on_switch_room_2_piston = not on_switch_room_2_piston
  # - ball_trap_open = ball_door_1 and ball_door_2
  # - ball_trap_closed = not ball_trap_open
  # - trapped = ball_trap_closed and in_ball_trap
  # - not_in_ball_trap = not in_ball_trap